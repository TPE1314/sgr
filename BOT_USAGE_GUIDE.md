# 🤖 机器人使用说明手册

## 📋 目录

- [系统概述](#系统概述)
- [投稿机器人使用指南](#投稿机器人使用指南)
- [发布机器人使用指南](#发布机器人使用指南)
- [控制机器人使用指南](#控制机器人使用指南)
- [用户操作流程](#用户操作流程)
- [管理员操作流程](#管理员操作流程)
- [常见问题解答](#常见问题解答)

---

## 📖 系统概述

电报机器人投稿系统由三个独立的机器人组成，各司其职：

### 🤖 三机器人分工

| 机器人 | 主要功能 | 目标用户 |
|--------|----------|----------|
| **投稿机器人** | 接收用户投稿、提供状态查询 | 普通用户 |
| **发布机器人** | 审核投稿、管理内容、发布到频道 | 管理员 |
| **控制机器人** | 系统管理、更新维护、配置管理 | 系统管理员 |

### 🔄 工作流程

```
用户投稿 → 投稿机器人 → 发布机器人(审核群组) → 频道发布
                                    ↓
控制机器人 ← 系统管理 ← 管理员操作
```

---

## 📝 投稿机器人使用指南

### 🎯 主要功能
- 接收各种类型的投稿内容
- 提供投稿状态查询
- 显示个人投稿统计

### 📱 支持的内容类型

| 内容类型 | 支持格式 | 说明 |
|----------|----------|------|
| 📄 **文本** | 纯文本、带格式文本 | 支持换行，自动格式化 |
| 🖼️ **图片** | JPG, PNG, GIF, WebP | 自动压缩，支持多张 |
| 🎥 **视频** | MP4, MOV, AVI | 自动生成缩略图 |
| 🎵 **音频** | MP3, WAV, OGG | 提取音频信息 |
| 📎 **文档** | PDF, DOC, TXT 等 | 文件大小限制50MB |
| 🎭 **贴纸** | Telegram贴纸 | 保持原始质量 |

### 💬 可用命令

#### `/start` - 开始使用
```
功能：显示欢迎信息和使用说明
示例：/start
```

#### `/status` - 查看投稿状态
```
功能：查看个人投稿统计信息
示例：/status

返回信息：
📊 您的投稿统计
📝 总投稿数：15
⏳ 待审核：3
✅ 已通过：10
📢 已发布：8
❌ 已拒绝：2
```

#### `/help` - 帮助信息
```
功能：显示详细的使用说明
示例：/help
```

### 📤 投稿操作流程

#### 1. 启动机器人
1. 在Telegram中搜索您的投稿机器人
2. 点击"开始"或发送 `/start`
3. 阅读使用说明

#### 2. 发送投稿内容
```
方式一：直接发送内容
- 直接发送文字、图片、视频等
- 机器人会自动接收并处理

方式二：添加描述
- 先发送媒体文件
- 然后添加文字描述
- 系统会自动组合
```

#### 3. 确认投稿
```
投稿成功后会收到确认消息：
✅ 投稿提交成功！

📄 投稿ID：#12345
📅 提交时间：2024-01-20 15:30
📊 状态：待审核
⏰ 预计审核时间：1-2小时

您可以随时发送 /status 查看投稿状态。
```

### ⚠️ 投稿注意事项

#### ✅ 允许的内容
- 原创内容
- 有价值的信息分享
- 正能量内容
- 合法合规内容

#### ❌ 禁止的内容
- 违法违规内容
- 色情暴力内容
- 广告推广（除非允许）
- 侵犯版权内容
- 垃圾信息

#### 📏 内容限制
- 文字：单条最多4096字符
- 图片：最大20MB，建议1080p
- 视频：最大50MB，建议720p
- 音频：最大50MB
- 文档：最大50MB

---

## 📢 发布机器人使用指南

### 🎯 主要功能
- 投稿审核管理
- 内容发布到频道
- 广告管理
- 审核群组管理

### 👥 审核群组功能

#### 📋 审核流程
1. **接收投稿**：自动转发到审核群组
2. **审核操作**：管理员点击按钮进行审核
3. **发布内容**：通过的投稿自动发布到频道
4. **统计反馈**：实时显示审核统计

#### 🔘 审核按钮说明

| 按钮 | 功能 | 说明 |
|------|------|------|
| ✅ **通过** | 批准投稿 | 内容将发布到频道 |
| ❌ **拒绝** | 拒绝投稿 | 投稿将被标记为拒绝 |
| ⏭️ **下一个** | 跳过当前 | 稍后再处理 |
| 📊 **统计** | 查看数据 | 显示审核统计信息 |

### 💬 管理员命令

#### `/start` - 开始使用
```
功能：初始化发布机器人
示例：/start
```

#### `/pending` - 查看待审核
```
功能：显示待审核投稿列表
示例：/pending

返回：显示最早的待审核投稿
```

#### `/stats` - 审核统计
```
功能：查看审核数据统计
示例：/stats

返回信息：
📊 审核统计 (今日)
📝 总投稿：45
⏳ 待审核：8
✅ 已通过：32
❌ 已拒绝：5
📊 通过率：86.5%
```

#### `/help` - 帮助信息
```
功能：显示管理员操作说明
示例：/help
```

### 📢 发布功能

#### 🎯 频道发布
- **自动发布**：审核通过后自动发布
- **格式优化**：自动美化内容格式
- **广告插入**：智能插入1-3条广告
- **多媒体处理**：自动处理图片视频

#### 📱 发布格式示例
```
📝 用户投稿内容

[原始投稿内容]

━━━━━━━━━━━━━━━━━━━━
🎯 广告位1：[广告内容]
🎯 广告位2：[广告内容]
━━━━━━━━━━━━━━━━━━━━

📅 投稿时间：2024-01-20
👤 投稿用户：@username
```

### 🎯 广告管理

#### 📊 广告类型
- **文本广告**：纯文字广告
- **链接广告**：带链接的广告
- **图片广告**：图文广告
- **按钮广告**：带按钮的广告

#### ⚙️ 广告设置
通过控制机器人可以设置：
- 广告内容和位置
- 显示概率和频次
- 投放时间段
- 目标用户群体

---

## 🔧 控制机器人使用指南

### 🎯 主要功能
- 系统配置管理
- 机器人更新维护 🆕
- 管理员权限管理
- 系统监控统计
- **一键更新系统** ⚡ 
- **数据互通修复** 🔧

### 👨‍💼 管理员权限

#### 🔑 权限级别
| 级别 | 权限范围 | 说明 |
|------|----------|------|
| **超级管理员** | 所有权限 | 系统最高权限 |
| **系统管理员** | 系统管理 | 可管理配置和更新 |
| **内容管理员** | 内容管理 | 可审核和发布内容 |

### 💬 系统管理命令

#### `/start` - 开始使用
```
功能：显示控制面板主菜单
示例：/start
```

#### `/status` - 系统状态
```
功能：查看系统运行状态
示例：/status

返回信息：
🖥️ 系统状态

⚡ 运行状态：正常
📊 CPU使用率：15.2%
💾 内存使用：2.1GB/8GB
💿 磁盘空间：45.2GB/100GB
📶 网络状态：正常

🤖 机器人状态：
• 投稿机器人：✅ 运行中
• 发布机器人：✅ 运行中
• 控制机器人：✅ 运行中
```

#### `/update` - 系统更新 🆕
```
功能：更新系统代码和依赖
示例：/update

⚡ v2.3.0 一键更新流程：
1️⃣ 🔄 自动备份当前系统
2️⃣ 🛑 安全停止所有机器人
3️⃣ 📦 从GitHub拉取最新代码
4️⃣ 🔧 自动更新Python依赖
5️⃣ 🐛 修复已知兼容性问题
6️⃣ ✅ 验证系统完整性
7️⃣ 🚀 重新启动所有服务
8️⃣ 📊 生成详细更新报告

🔧 新增修复功能：
• Markdown实体解析错误修复
• Telegram过滤器兼容性修复
• 数据库互通问题修复
• 配置文件路径统一
```

#### 🔧 数据互通修复
```
命令：/fix_data_sync
功能：修复投稿和发布机器人数据不互通问题

适用场景：
❌ 投稿显示"待审核"但发布机器人看不到
❌ 投稿和发布数据不同步  
❌ 审核操作不生效

修复内容：
✅ 统一数据库配置路径
✅ 检查数据库一致性
✅ 修复配置文件问题
✅ 测试数据同步功能
✅ 验证机器人互通性
```

#### `/config` - 配置管理
```
功能：管理系统配置
示例：/config

配置选项：
🔧 基础配置
📢 频道设置  
🎯 广告管理
👥 用户管理
🔔 通知设置
```

#### `/logs` - 查看日志
```
功能：查看系统运行日志
示例：/logs

日志类型：
📋 系统日志
🤖 机器人日志
❌ 错误日志
🔍 审核日志
```

#### `/backup` - 数据备份
```
功能：创建系统备份
示例：/backup

备份内容：
💾 数据库文件
⚙️ 配置文件
📝 日志文件
📁 上传文件
```

#### `/restart` - 重启服务
```
功能：重启指定服务
示例：/restart

重启选项：
🔄 重启所有机器人
🤖 重启投稿机器人
📢 重启发布机器人
🔧 重启控制机器人
```

### 👥 管理员管理

#### 🔧 添加管理员
```
操作：/config → 👥 用户管理 → ➕ 添加管理员
步骤：
1. 选择权限级别
2. 输入用户ID或用户名
3. 确认添加
```

#### ❌ 移除管理员
```
操作：/config → 👥 用户管理 → ➖ 移除管理员  
步骤：
1. 选择要移除的管理员
2. 确认移除操作
```

#### 📝 管理员列表
```
操作：/config → 👥 用户管理 → 📋 管理员列表
显示：
• 用户ID和用户名
• 权限级别
• 添加时间
• 最后活动时间
```

### 🎯 广告管理

#### ➕ 添加广告
```
操作：/config → 🎯 广告管理 → ➕ 添加广告
参数：
📝 广告内容：文字描述
🔗 广告链接：目标链接
📱 按钮文字：按钮显示文字
📊 显示概率：0-100%
⏰ 投放时间：开始-结束时间
```

#### 📝 编辑广告
```
操作：/config → 🎯 广告管理 → ✏️ 编辑广告
功能：
• 修改广告内容
• 调整显示概率
• 设置投放时间
• 启用/禁用广告
```

#### 📊 广告统计
```
操作：/config → 🎯 广告管理 → 📊 广告统计
显示：
• 广告展示次数
• 点击率统计
• 转化效果
• 收益分析
```

### 🔄 文件更新功能

#### 📁 单文件更新
```
操作：直接发送Python文件给控制机器人
支持：.py, .sh, .json, .ini等
流程：
1️⃣ 发送文件
2️⃣ 自动分析变更
3️⃣ 智能重启建议
4️⃣ 确认更新
```

#### 📦 批量更新
```
操作：发送zip或tar.gz压缩包
流程：
1️⃣ 上传压缩包
2️⃣ 解析文件结构
3️⃣ 预览变更内容
4️⃣ 确认批量更新
```

---

## 👤 用户操作流程

### 📝 投稿流程

#### 第一次使用
1. **启动投稿机器人**
   - 搜索并添加投稿机器人
   - 发送 `/start` 开始使用
   - 阅读使用说明

2. **准备投稿内容**
   - 确保内容符合要求
   - 检查文件大小和格式
   - 添加必要的描述信息

3. **提交投稿**
   - 直接发送内容给机器人
   - 等待确认消息
   - 记录投稿ID

4. **查看状态**
   - 发送 `/status` 查看投稿状态
   - 等待审核结果
   - 关注频道发布

### 📊 状态查询
```
投稿状态说明：
⏳ 待审核：投稿已提交，等待管理员审核
✅ 已通过：投稿通过审核，准备发布
📢 已发布：投稿已发布到频道
❌ 已拒绝：投稿未通过审核
```

---

## 👨‍💼 管理员操作流程

### 📋 审核流程

#### 日常审核工作
1. **进入审核群组**
   - 确保已加入审核群组
   - 关注机器人推送的投稿

2. **审核投稿内容**
   - 查看投稿内容和用户信息
   - 检查是否符合发布标准
   - 注意内容质量和原创性

3. **执行审核操作**
   ```
   ✅ 通过：内容优质，符合标准
   ❌ 拒绝：内容不符合要求
   ⏭️ 跳过：暂时无法决定，稍后处理
   ```

4. **查看审核结果**
   - 投稿自动发布到频道
   - 查看发布效果
   - 关注用户反馈

### 📊 数据管理
```
定期工作：
📈 查看投稿统计
📊 分析用户活跃度
🎯 优化广告效果
📢 调整发布策略
```

### 🔧 系统维护

#### 定期维护任务
1. **系统监控**
   - 检查机器人运行状态
   - 监控系统资源使用
   - 查看错误日志

2. **数据备份**
   - 定期创建数据备份
   - 验证备份完整性
   - 清理过期日志

3. **性能优化**
   - 清理临时文件
   - 优化数据库
   - 更新系统依赖

4. **安全检查**
   - 检查管理员权限
   - 审查异常操作
   - 更新安全配置

---

## ❓ 常见问题解答

### 👤 用户常见问题

#### Q1: 投稿没有收到确认消息怎么办？
```
A: 可能的原因和解决方法：
1. 检查网络连接是否正常
2. 确认发送的内容符合格式要求
3. 发送 /status 查看投稿记录
4. 联系管理员确认机器人状态
```

#### Q2: 投稿被拒绝了怎么办？
```
A: 拒绝后的处理方式：
1. 查看拒绝原因（如有提供）
2. 修改内容后重新投稿
3. 确保内容符合社区规范
4. 联系管理员了解具体要求
```

#### Q3: 可以删除已提交的投稿吗？
```
A: 投稿删除说明：
• 待审核状态：联系管理员删除
• 已通过状态：一般不可删除
• 已发布状态：无法删除
• 建议：提交前仔细检查内容
```

#### Q4: 支持哪些文件格式？
```
A: 支持的格式：
📝 文本：纯文本、Markdown格式
🖼️ 图片：JPG、PNG、GIF、WebP
🎥 视频：MP4、MOV、AVI、WEBM
🎵 音频：MP3、WAV、OGG、M4A
📎 文档：PDF、DOC、DOCX、TXT
🎭 其他：贴纸、位置等
```

### 👨‍💼 管理员常见问题

#### Q1: 如何添加新的管理员？
```
A: 添加管理员步骤：
1. 使用控制机器人发送 /config
2. 选择 👥 用户管理
3. 点击 ➕ 添加管理员
4. 输入用户ID或用户名
5. 选择权限级别
6. 确认添加
```

#### Q2: 如何修改广告内容？
```
A: 修改广告步骤：
1. 使用控制机器人发送 /config  
2. 选择 🎯 广告管理
3. 点击 ✏️ 编辑广告
4. 选择要修改的广告
5. 编辑内容和设置
6. 保存修改
```

#### Q3: 机器人没有响应怎么办？
```
A: 故障排除步骤：
1. 检查机器人运行状态：/status
2. 查看系统日志：/logs
3. 尝试重启服务：/restart
4. 检查服务器资源使用情况
5. 必要时联系技术支持
```

#### Q4: 如何备份和恢复数据？
```
A: 数据备份步骤：
1. 使用控制机器人发送 /backup
2. 选择备份类型和范围
3. 等待备份完成
4. 下载备份文件保存

恢复数据：
1. 停止所有服务
2. 替换数据库文件
3. 恢复配置文件
4. 重启系统服务
```

### 🔧 技术问题

#### Q1: 系统更新失败怎么办？
```
A: 更新失败处理：
1. 查看更新日志确认错误原因
2. 检查网络连接和Git配置
3. 手动拉取代码：git pull
4. 解决依赖冲突：pip install -r requirements.txt
5. 重启服务：systemctl restart telegram-bots
```

#### Q2: 数据库错误如何解决？
```
A: 数据库问题处理：
1. 运行数据库修复脚本
2. 检查数据库文件权限
3. 重新初始化数据库
4. 从备份恢复数据
5. 联系技术支持
```

#### Q3: 内存使用过高怎么办？
```
A: 内存优化方法：
1. 重启所有机器人服务
2. 清理临时文件和日志
3. 优化数据库连接池
4. 检查内存泄漏问题
5. 考虑升级服务器配置
```

---

## 📞 技术支持

### 🆘 获取帮助
- **GitHub Issues**: [提交问题](https://github.com/TPE1314/sgr/issues)
- **文档更新**: 定期查看项目文档
- **社区讨论**: 参与项目讨论

### 📋 报告问题时请提供
1. 错误详细描述
2. 复现步骤
3. 系统环境信息
4. 相关日志信息
5. 配置文件内容（敏感信息请脱敏）

---

## 📚 相关文档

- [安装教程](README.md#安装教程)
- [配置说明](CONFIG_GUIDE.md)
- [API 文档](API_DOCUMENTATION.md)
- [故障排除](TROUBLESHOOTING_GUIDE.md)
- [更新日志](CHANGELOG.md)

---

*最后更新：2024-01-20*
*版本：v2.3.0*